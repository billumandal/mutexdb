<?php

//  PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
//  For more information visit: http://www.projecthoneypot.org/
//  Copyright (C) 2004-2014, Unspam Technologies, Inc.
//  
//  This program is free software; you can redistribute it and/or modify
//  it under the terms of the GNU General Public License as published by
//  the Free Software Foundation; either version 2 of the License, or
//  (at your option) any later version.
//  
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU General Public License for more details.
//  
//  You should have received a copy of the GNU General Public License
//  along with this program; if not, write to the Free Software
//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
//  02111-1307  USA
//  
//  If you choose to modify or redistribute the software, you must
//  completely disconnect it from the Project Honey Pot Service, as
//  specified under the Terms of Service Use. These terms are available
//  here:
//  
//  http://www.projecthoneypot.org/terms_of_service_use.php
//  
//  The required modification to disconnect the software from the
//  Project Honey Pot Service is explained in the comments below. To find the
//  instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
//  
//  Generated On: Fri, 03 Oct 2014 10:06:19 -0700
//  For Domain: mutexdb.com
//  
//  

//  *** DISCONNECT INSTRUCTIONS ***
//  
//  You are free to modify or redistribute this software. However, if
//  you do so you must disconnect it from the Project Honey Pot Service.
//  To do this, you must delete the lines of code below located between the
//  *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
//  Terms of Service Use that you agreed to before downloading this software,
//  you may not recreate the deleted lines or modify this software to access
//  or otherwise connect to any Project Honey Pot server.
//  
//  *** START CUT HERE ***
//  
define('__REQUEST_HOST', 'hpr3.projecthoneypot.org');
define('__REQUEST_PORT', '80');
define('__REQUEST_SCRIPT','/cgi/serve.php');
//  
//  *** FINISH CUT HERE ***
//  

define('__HPOT_TAG1',    '416c7d76f3dfda940ac08f6001fc1ef5');
define('__HPOT_TAG2',    '0904e89fc1299b40968390285eef2047');
define('__HPOT_TAG3',    '34aa2473d1aa4705f92165addfe297ff');

define('__CLASS_STYLE_1','tucl');
define('__CLASS_STYLE_2','clupr');

define('__DIV1',         'tr857s');

define('__VANITY_L1',    'MEMBER OF PROJECT HONEY POT');
define('__VANITY_L2',    'Spam Harvester Protection Network');
define('__VANITY_L3',    'provided by Unspam');

define('__DOC_TYPE1',    '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n');
define('__HEAD1',        '<html>\n<head>\n');
define('__HEAD2',        '<title>mutexdb.com</title>\n</head>\n');
define('__ROBOT1',       '<meta name="robots" content="follow">\n<meta name="robots" content="noindex">\n<meta name="robots" content="noarchive">\n');
define('__NOCOLLECT1',   '<meta name="no-email-collection" content="/">\n');
define('__TOP1',         '<body>\n<div id="sacramental" align="center">\n');
define('__EMAIL1A',      '<a href="mailto:');
define('__EMAIL1B',      '" style="display: none;">');
define('__EMAIL1C',      '</a>');
define('__EMAIL2A',      '<a href="mailto:');
define('__EMAIL2B',      '" style="display:none;">');
define('__EMAIL2C',      '</a>');
define('__EMAIL3A',      '<a style="display: none;" href="mailto:');
define('__EMAIL3B',      '">');
define('__EMAIL3C',      '</a>');
define('__EMAIL4A',      '<a style="display:none;" href="mailto:');
define('__EMAIL4B',      '">');
define('__EMAIL4C',      '</a>');
define('__EMAIL5A',      '<a href="mailto:');
define('__EMAIL5B',      '"></a>');
define('__EMAIL5C',      '..');
define('__EMAIL6A',      '<span style="display: none;"><a href="mailto:');
define('__EMAIL6B',      '">');
define('__EMAIL6C',      '</a></span>');
define('__EMAIL7A',      '<span style="display:none;"><a href="mailto:');
define('__EMAIL7B',      '">');
define('__EMAIL7C',      '</a></span>');
define('__EMAIL8A',      '<!-- <a href="mailto:');
define('__EMAIL8B',      '">');
define('__EMAIL8C',      '</a> -->');
define('__EMAIL9A',      '<div id="'.__DIV1.'"><a href="mailto:');
define('__EMAIL9B',      '">');
define('__EMAIL9C',      '</a></div><br><script language="JavaScript" type="text/javascript">document.getElementById(\''.__DIV1.'\').innerHTML=\'\';</script>');
define('__EMAIL10A',     '<a href="mailto:');
define('__EMAIL10B',     '"><!-- ');
define('__EMAIL10C',     ' --></a>');
define('__LEGAL1',       '');
define('__LEGAL2',       '\n');
define('__STYLE1',       '\n<style>a.'.__CLASS_STYLE_1.'{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>');
define('__VANITY1',      '<table cellspacing="0"cellpadding="0"border="0"style="background:#999;width:230px;"><tr><td valign="top"style="padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;"><span style="font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;">@</span></td><td valign="top" align="left" style="padding:3px 0 0 4px;"><a href="http://www.projecthoneypot.org/" class="'.__CLASS_STYLE_1.'">'.__VANITY_L1.'</a><br><a href="http://www.unspam.com"class="'.__CLASS_STYLE_1.'">'.__VANITY_L2.'<br>'.__VANITY_L3.'</a></td></tr></table>\n');
define('__BOTTOM1',      '</div>\n</body>\n</html>\n');


function getLegalContent() { return '<table cellpadding="0" cellspacing="0" border="0">\n<tr>\n<td><tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <b><font color=#FFFFFF>a</font></b>&nbsp;<br>&nbsp;<br>The web&#115;i&#116;e from<br>to<font color=#FFFFFF>i</font>you su&#98;&#106;ect t<br>other<font color=#FFFFFF>d</font>terms gov&#101;<br>Website y&#111;u acce<br>read t&#104;em<font color=#FFFFFF>s</font>caref&#117;<br>agen&#116;s of the<font color=#FFFFFF>o</font>i&#110;<br>&#116;hem. The access<br>&#110;&#111;&#110;-transferab&#108;e<br>Website.<br><br>&nbsp; &nbsp;&nbsp; <b><font color=#FFFFFF>i</font></b>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <b>S</b><br>&nbsp;<br>Speci&#97;&#108; res&#116;&#114;ict<br>N&#111;n-Human<font color=#FFFFFF>t</font>Visi&#116;o<br>spid&#101;rs, bots, i<br>programs &#100;e&#115;igne<br>a&#117;t&#111;mat&#105;call&#121;.<br><br>&#69;ma&#105;l addr&#101;sse&#115; <br>It is recognized<br>alone. Yo<span style="display: none">learned hedge reference monophonic</span>u ackno<br>has a val&#117;e no&#116; <br>sto&#114;age&#44; a<span style="display: none">sensitive upperclass subjective defensive fun</span>nd/<span style="display: none">pyrophoric</span>&#111;r <br>val&#117;e of these a<br>stor&#105;n&#103; this &#87;eb<br>agreem&#101;nt an&#100; e<span style="display: none">implementation taxi supranational</span>x<br><br>&nbsp; <b><font color=#FFFFFF>e</font></b>&nbsp;&nbsp; <b><font color=#FFFFFF>f</font></b>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp;<br>Ea&#99;h part&#121; agree<br>&#97;g<span style="display: none">beer essence queen chockablock</span>ainst t&#104;e othe<br>("Judicial Actio<br>&#116;he reg&#105;stere&#100; A<br>such<font color=#FFFFFF>o</font>laws are ap<br>&#97;nd &#112;erformed en<br>of feder<span style="display: none">selfwinding swallowtailed poison apologetic</span>al an&#100; s<br>any act&#105;&#111;n brou<span style="display: none">workshop textual giltedged soupy gown</span>&#103;<br>Serv&#105;ce<span style="display: none">species domical photogenic underground transmission</span>. You con<br>the ab&#111;ve a&#103;reem<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <b><font color=#FFFFFF>a</font></b>&nbsp;<b><font color=#FFFFFF>o</font><font color=#FFFFFF>f</font></b>&nbsp;<br>&nbsp;<br>You cons&#101;nt &#116;o h<br>m&#97;&#121;<font color=#FFFFFF>c</font>appear somew<br>abuse. Th&#101; Ident<br>Vis&#105;tors agree n<br><br>VISI&#84;ORS AGREE T<br>P<span style="display: none">cargo venal</span>ARTY O&#82; SENDIN<span style="display: none">fitness</span>G<br>SU&#66;SEQUENT<font color=#FFFFFF>h</font>BRE&#65;C<br></tt></td>\n<td><tt><b><font color=#FFFFFF>a</font></b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <b>TERMS</b><br><br>&nbsp;&#119;&#104;ich you ac<span style="display: none">available breast</span>ce&#115;<br>o the follo&#119;ing <br>&#114;ning acce<span style="display: none">buxom vehicular unconstitutional abstract</span>ss to <br>pt these ter<span style="display: none">kangaroos</span>ms a<br>lly. Any &#78;on-Hum<br>di&#118;idua&#108;(s) wh&#111; <br>&nbsp;rights &#103;ranted<font color=#FFFFFF>p</font><br>&nbsp;&#119;it&#104;&#111;ut<font color=#FFFFFF>s</font>t&#104;e exp<br><br><br><b>PECIAL</b>&nbsp;<b>LICENSE</b>&nbsp;<b>&#82;</b><br><br>ions<font color=#FFFFFF>p</font>o&#110; a visito<br>rs. N&#111;n-&#72;uman<font color=#FFFFFF>s</font>Vi<br>&#110;dex&#101;r<span style="display: none">short victim yummy digital</span>&#115;, r<span style="display: none">research luxury invertebrate desire wood</span>obots,<br>d to acces&#115;,<font color=#FFFFFF>c</font>rea<br><br><br>on this site &#97;re<br>&nbsp;that th&#101;se em&#97;i<br>wl&#101;dge and ag&#114;ee<br>less than US $5&#48;<br>distri&#98;&#117;tion of<font color=#FFFFFF>s</font><br>ddres&#115;es. Inte&#110;t<br>site\'s email add<br>pressly p&#114;&#111;h&#105;bit<br><br>&nbsp; <b><font color=#FFFFFF>i</font><font color=#FFFFFF>d</font><font color=#FFFFFF>a</font></b>&nbsp;<b><font color=#FFFFFF>p</font></b>&nbsp; <b>APPLI<span style="display: none">tartan</span>CA</b><br><br>s that<font color=#FFFFFF>c</font>a&#110;y suit,<br>r i&#110; conn&#101;&#99;&#116;i&#111;n<font color=#FFFFFF>a</font><br>n") shall be gov<br>dmini&#115;tra&#116;i&#118;e Co<br>pli&#101;d t&#111; agreeme<br>t&#105;rely<font color=#FFFFFF>t</font>wit&#104;in th<br>&#116;ate &#99;our&#116;&#115; with<br>ht against him i<br>sent to<font color=#FFFFFF>d</font>ele<span style="display: none">word salutatory shore understood</span>&#99;tron<br>e&#110;t&#46;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; <b>RECORDS</b>&nbsp;<br><br>&#97;ving your Inter<br>he&#114;&#101; on &#116;hi&#115; pag<br>ifie&#114; is uniquel<br>ot to use &#116;hi<span style="display: none">segue hollow</span>s a<br><br>HAT HARV&#69;STING, <br><font color=#FFFFFF>a</font>ANY MESSAG&#69;(S&#41; <br>H OF THESE TERMS<br></tt></td>\n<td><tt>&nbsp;<b>AN&#68;</b>&nbsp;<b>CONDITIONS</b>&nbsp;<br><br>sed th&#105;s<font color=#FFFFFF>f</font>agre<span style="display: none">feudal visitor clerk</span>eme<br>&#99;ondi&#116;ions.<span style="display: none">bliss noun staccato massive</span>&nbsp;Thes<br>th&#101;<font color=#FFFFFF>g</font>Web&#115;i&#116;&#101;. By <br>&#110;d<font color=#FFFFFF>f</font>con&#100;itions &#40;t<br>&#97;&#110; Visito&#114;s &#116;o t<br>contro&#108;s, au&#116;hor<br>t&#111;<font color=#FFFFFF>h</font>you under the<br>ress wr&#105;tten per<br><br><br><b>ESTRICTIONS</b>&nbsp;<b>FOR</b>&nbsp;<br><br>&#114;\'s license<font color=#FFFFFF>t</font>&#116;o a<br>&#115;itors include,<font color=#FFFFFF>c</font><br>&nbsp;crawlers, harve<br>d, compile<font color=#FFFFFF>h</font>or ga<br><br><br>&nbsp;conside&#114;ed prop<br>l addresses<font color=#FFFFFF>g</font>are <br>&nbsp;that ea&#99;h email<br>. &#89;ou further a<span style="display: none">bracing duke inch gone</span>g<br>these addr&#101;&#115;se<span style="display: none">turtles</span>&#115; <br>&#105;o&#110;al col&#108;ecti&#111;n<br>resses is r&#101;c&#111;gn<br>&#101;d.<br><br><b>BLE<span style="display: none">ace rooty quadrivalent</span></b>&nbsp;<b>LAW</b>&nbsp;<b>AND</b>&nbsp;<b>JUR&#73;</b><br><br>&nbsp;ac&#116;io&#110; or p&#114;oce<br>with or a&#114;isi&#110;g <br>erned<font color=#FFFFFF>p</font>b&#121;<font color=#FFFFFF>d</font>the l<span style="display: none">congregational programmatic subaltern odor</span>aw<br>nt&#97;ct (th&#101; "&#65;dmi<br>nt&#115; be&#116;we<span style="display: none">capital championship byte eyesight</span>en<font color=#FFFFFF>p</font>&#65;&#100;&#109;i<br>e Admi&#110; State. &#89;<br>in the Admin St&#97;<br>n connection wit<br>&#105;c ser&#118;ice of pr<br><br><br><b>OF<font color=#FFFFFF>s</font>VISITOR</b>&nbsp;<b>USE</b>&nbsp;<b>&#65;</b><br><br>net Protocol add<br>e (the "Identifi<br>y m&#97;&#116;ched to you<br>&#100;dre&#115;s &#102;or any r<br><br>GATHERING, STORI<br>TO THE &#73;DENTIFI&#69;<br>&nbsp;OF<span style="display: none">woodpeckers flowers directive maximum subsequent</span>&nbsp;SERVICE.<br></tt></td>\n<td><tt><b>OF</b>&nbsp;<b>USE</b>&nbsp;<br><br>nt ("t&#104;e W&#101;bsite<br>e terms a&#114;e<font color=#FFFFFF>s</font>in a<br>visiting (in &#97;&#110;y<br>he "Terms of<font color=#FFFFFF>p</font>Ser<br>he Website shall<br>s or othe&#114;w&#105;se<font color=#FFFFFF>a</font>&#109;<br>&nbsp;Terms of S&#101;rvic<br>missi&#111;n o&#102;<font color=#FFFFFF>o</font>the o<br><br><br><b>NON&#45;&#72;U&#77;AN</b>&nbsp;<b>VI&#83;ITO</b><br><br>ccess the<font color=#FFFFFF>d</font>W&#101;bs&#105;t<br>but &#97;re no&#116;<font color=#FFFFFF>i</font>limi<br>&#115;t&#101;rs, &#111;r a<span style="display: none">front chesty sin</span>ny ot<br>the<span style="display: none">sentence counterclockwise arsonists backhand figured</span>r cont&#101;nt fro<br><br><br>rietar&#121;<font color=#FFFFFF>t</font>i&#110;tellec<br>provided fo&#114; hu&#109;<br><font color=#FFFFFF>k</font>address<font color=#FFFFFF>g</font>&#116;h&#101; Web<br>r&#101;e t&#104;&#97;&#116; th&#101; c&#111;m<br>sub&#115;&#116;a&#110;tia&#108;&#108;y di<br>,<font color=#FFFFFF>i</font>&#104;arvest&#105;ng, ga<br>ized as a violat<br><br><br><b>S&#68;ICT&#73;&#79;N</b>&nbsp;<br><br>eding b&#114;ou&#103;ht by<br>from t<span style="display: none">finding collapse</span>he Terms<font color=#FFFFFF>e</font>o<br>&nbsp;of &#116;he state o&#102;<br>n State") for th<br>&#110; &#83;tat&#101; resident<br>&#111;u c<span style="display: none">silly</span>o<span style="display: none">percentage medial page kind</span>nsent to th<br>te. You co&#110;sent<font color=#FFFFFF>c</font><br>&#104; br<span style="display: none">warlock tidal punch scrutiny equal</span>each&#101;s o&#102; th<br>ocess<font color=#FFFFFF>f</font>reg&#97;rding <br><br><br><b>ND</b>&nbsp;<b>ABUSE</b>&nbsp;<br><br>ress<font color=#FFFFFF>c</font>r<span style="display: none">borough</span>ec&#111;rde&#100;.<font color=#FFFFFF>t</font>A<span style="display: none">super potato warning</span><br>er")<font color=#FFFFFF>d</font>if<font color=#FFFFFF>o</font>w&#101; &#115;usp&#101;<br>r Internet Prot<span style="display: none">returnable</span>o<br>eason.<br><br>NG, T&#82;ANSFERRING<br>R CONS&#84;ITUTE<span style="display: none">native wee intermediate daily</span>S AN<br><br></tt></td>\n<td><tt><br><br>") is prov&#105;ded<br>dditi&#111;n t&#111; any<br>&nbsp;ma&#110;ner) the<br>vice"). Please<br>&nbsp;be co&#110;s&#105;dered<br>a&#107;e&#115; use of<br>&#101; are<br>wner &#111;&#102; the<br><br><br><b>R<span style="display: none">sordid</span>S</b>&nbsp;<br><br>e appl&#121; to<br>ted to, web<br>&#104;&#101;r com&#112;uter<br>m th&#101;<font color=#FFFFFF>i</font>Website<br><br><br>tu&#97;&#108;<font color=#FFFFFF>i</font>pr&#111;pe&#114;ty&#46;<br>an visitor&#115;<br>site contains<br>pilati&#111;n,<br>min&#105;&#115;hes<font color=#FFFFFF>c</font>t&#104;e<br>thering, a&#110;d/or<br>ion of this<br><br><br><br><br>&nbsp;&#115;uc&#104; party<br>f<font color=#FFFFFF>t</font>&#83;er&#118;ice<br>&nbsp;r&#101;sidenc&#101;<font color=#FFFFFF>a</font>&#111;&#102;<br>e Website as<br>s ent<span style="display: none">dreadful zerobase silly kiss</span>ered into<br>e jur<span style="display: none">outcast west topic</span>isdict&#105;on<br>to the venue in<br>e&#115;e Terms of<br>action&#115;<font color=#FFFFFF>k</font>under<br><br><br><br><br>&#110; ema&#105;&#108; addr&#101;ss<br>ct &#112;otential<br>col addre&#115;s.<br><br><br>&nbsp;TO<font color=#FFFFFF>h</font>A<font color=#FFFFFF>t</font>T&#72;IR&#68;<br>&nbsp;ACCEPTANC&#69; AND<br><br></tt></td>\n</tr>\n</table>\n<br>'; }


?><?php 

// 
// PROXY SUPPORT
//  
// This honey pot script supports Proxies. If your webserver requires a proxy
// for outbound connections you may configure this honey pot's settings to use
// a proxy.
//
// For more information, visit: 
//     http://www.projecthoneypot.org/settings_help.php
//
//



function formatHTML($s) {
    return str_replace('\n',"\n",$s);
}

function getDocType()       { return formatHTML(__DOC_TYPE1); }
function getHeadHTML1()     { return formatHTML(__HEAD1); }
function getRobotHTML()     { return formatHTML(__ROBOT1); }
function getNoCollectHTML() { return formatHTML(__NOCOLLECT1); }
function getHeadHTML2()     { return formatHTML(__HEAD2); }
function getTopHTML()       { return formatHTML(__TOP1); }
function getEmailHTML($method,$m) { 
    switch ($method) {
    case 0: return "";
    case 1: return formatHTML(__EMAIL1A.$m.__EMAIL1B.$m.__EMAIL1C); 
    case 2: return formatHTML(__EMAIL2A.$m.__EMAIL2B.$m.__EMAIL2C); 
    case 3: return formatHTML(__EMAIL3A.$m.__EMAIL3B.$m.__EMAIL3C); 
    case 4: return formatHTML(__EMAIL4A.$m.__EMAIL4B.$m.__EMAIL4C); 
    case 5: return formatHTML(__EMAIL5A.$m.__EMAIL5B); 
    case 6: return formatHTML(__EMAIL6A.$m.__EMAIL6B.$m.__EMAIL6C); 
    case 7: return formatHTML(__EMAIL7A.$m.__EMAIL7B.$m.__EMAIL7C); 
    case 8: return formatHTML(__EMAIL8A.$m.__EMAIL8B.$m.__EMAIL8C); 
    case 9: return formatHTML(__EMAIL9A.$m.__EMAIL9B.$m.__EMAIL9C); 
    }
    return formatHTML(__EMAIL10A.$m.__EMAIL10B.$m.__EMAIL10C); 
}
function getLegalHTML()   { return formatHTML(__LEGAL1.(getLegalContent()).__LEGAL2); }
function getStyleHTML()   { return formatHTML(__STYLE1); }
function getVanityHTML()  { return formatHTML(__VANITY1); }
function getBottomHTML()  { return formatHTML(__BOTTOM1); }

function readSettings() {
    $settings      = NULL;
    $settings_file = dirname(__FILE__)."/phpot_settings.php";

    if (is_file($settings_file) && is_readable($settings_file)) {
        $fp = fopen($settings_file,"r");
        $contents = "";
        while (!feof($fp)) {
            $contents .= fread($fp, 8192);
        }
        fclose($fp);

        $lines = explode("\n",$contents);
        foreach ($lines as $line) {
            if (trim($line) !== "") {
                list ($setting, $value) = @explode(":",$line,2);
                switch ($setting) {
                case "proxy_host": 
                    $settings["sock_host"] = trim($value);
                    break;
                case "proxy_port":
                    $settings["sock_port"] = trim($value);
                    break;
                }
                if (trim($value) !== "") {
                    $settings[trim($setting)] = trim($value);
                }
            }
        }
    }

    if (isset($settings["proxy_host"]) && isset($settings["proxy_port"]) && !isset($settings["use_proxy"])) {
        $settings["use_proxy"] = "1";
    } else {
        $settings["use_proxy"] = "0";
    }

    if (isset($settings["proxy_user"]) && isset($settings["proxy_pass"]) && !isset($settings["proxy_auth"])) {
        $settings["proxy_auth"] = "basic";
    } else {
        $settings["proxy_auth"] = "none";
    }

    if (!isset($settings["sock_host"])) $settings["sock_host"] = __REQUEST_HOST;
    if (!isset($settings["sock_port"])) $settings["sock_port"] = __REQUEST_PORT;

    return $settings;
}

function performRequest($request) {
    $response = "";

    $settings = readSettings();

    if ($settings["use_proxy"] == "1") {
        // POST via proxy
        $post_url = "http://".__REQUEST_HOST.":".__REQUEST_PORT.__REQUEST_SCRIPT;

        $head  = "POST ".$post_url." HTTP/1.0\r\n";
        //$head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        if ($settings["proxy_auth"] == "basic") {
            $head .= "Proxy-Authorization: Basic ".base64_encode($settings["proxy_user"].":".$settings["proxy_pass"])."\r\n";
        }
        $head .= "Cache-Control: no-store, no-cache\r\n";
        $head .= "Accept: */*\r\n";
        $head .= "Pragma: no-cache\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";

    } else {
        // POST directly
        $head  = "POST ".__REQUEST_SCRIPT." HTTP/1.1\r\n";
        $head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";
    }
    
    $errno  = NULL;
    $errstr = NULL;
    $fd = @fsockopen ($settings["sock_host"], $settings["sock_port"], $errno, $errstr, 20);

    if (!$fd) {
        // Socket Error
        die("\n<BR>Unable to contact the Server. Are outbound connections disabled? (If a proxy is required for outbound traffic, you may configure the honey pot to use a proxy. For instructions, visit http://www.projecthoneypot.org/settings_help.php)<BR>\n");
        return "-1";
    } else {

        fputs($fd,$head.$request);
        while(!feof($fd)) {
            $response .= fgets($fd,4096);
        }
        fclose($fd);
    }

    return $response;
}

function prepareRequest() {
    $postvars          = array();
    $postvars["tag1"]  = __HPOT_TAG1;
    $postvars["tag2"]  = __HPOT_TAG2;
    $postvars["tag3"]  = __HPOT_TAG3;
    if (!($handle = fopen(__FILE__,"r"))) {
        die("\n<BR>Unable to read contents of ".__FILE__." for hashing<BR>\n");
        return -2;
    }
    $contents = "";
    while (!feof($handle)) {
        $contents .= fread($handle, 8192);
    }
    fclose($handle);
    $postvars["tag4"]   = md5(preg_replace("/[^a-zA-Z0-9]/","",$contents));
    $postvars["ip"]    = $_SERVER["REMOTE_ADDR"];
    $postvars["svrn"]  = $_SERVER["SERVER_NAME"];  
    $postvars["svp"]   = $_SERVER["SERVER_PORT"];  
    $postvars["svip"]  = isset($_SERVER["SERVER_ADDR"]) ? $_SERVER["SERVER_ADDR"] : "";
    $postvars["rquri"]   = isset($_SERVER["REQUEST_URI"]) ? $_SERVER["REQUEST_URI"] : "";
    $postvars["phpself"] = str_replace(' ','%20',$_SERVER["PHP_SELF"]);
    $postvars["version"] = "php-".phpversion();
    $postvars["sn"]     = str_replace(' ','%20',$_SERVER["SCRIPT_NAME"]);
    $postvars["ref"]    = isset($_SERVER["HTTP_REFERER"]) ? $_SERVER["HTTP_REFERER"] : "";
    $postvars["uagnt"]  = isset($_SERVER["HTTP_USER_AGENT"]) ? $_SERVER["HTTP_USER_AGENT"] : "";
    if (isset($_POST) && count($_POST) > 0) {
        $postvars["has_post"] = count($_POST);
        for (reset($_POST);list($k,$v) = each($_POST);) {
            $postvars["post|".$k] = $v;
        }
        reset($_POST);
    }
    if (isset($_GET) && count($_GET) > 0) {
        $postvars["has_get"] = count($_GET);
        for (reset($_GET);list($k,$v) = each($_GET);) {
            $postvars["get|".$k] = $v;
        }
        reset($_GET);
    }
    if (isset($_SERVER) && count($_SERVER) > 0) {
        $i = 0;
        for (reset($_SERVER);list($k,$v) = each($_SERVER);) {
            if ($k !== "HTTP_COOKIE" && preg_match('/^HTTP_/',$k)) {
                $postvars["header|".$k] = $v;
                $i++;
            }
        }
        $postvars["has_header"] = $i;
        reset($_SERVER);
    }

    return $postvars;
}

function transcribeResponse(& $response) {
    $settings  = NULL;
    $arr       = explode("\n",$response);
    $isParam   = FALSE;

    
    for ($i=0;list(,$v)=each($arr);$i++) {
        if ($v == "<END>")   $isParam = FALSE;

        if ($isParam) {          
            $pieces = explode("=",$v,2);
            $settings[$pieces[0]] = urldecode($pieces[1]);
        }
        if ($v == "<BEGIN>") $isParam = TRUE;
    }
    

    if (isset($settings["directives"])) {
        $settings["directives"] = explode(",",$settings["directives"]);
    }

    return $settings;
}

header("Cache-Control: no-store, no-cache");
header("Pragma: no-cache");

$response  = "";
$request   = "";
$post      = prepareRequest();

for (reset($post);list($k,$v) = each($post);) {
    $request .= "&".urlencode($k)."=".urlencode(stripslashes($v));
}
$request    = substr($request,1);
$response   = performRequest($request);
if ($response == "-1") {
    exit();
}
$settings   = transcribeResponse($response);

$directives   = $settings["directives"];
$email        = isset($settings["email"]) ? $settings["email"] : "";
$emailmethod  = isset($settings["emailmethod"]) ? $settings["emailmethod"] : 0;




?>
<?php echo (isset($directives[0]) && $directives[0]==1) ? getDocType()    : ""; ?>
<?php echo (isset($settings["injDocType"])) ? formatHTML($settings["injDocTypeMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML1()   : ""; ?>
<?php echo (isset($settings["injHead1HTML"])) ? formatHTML($settings["injHead1HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[8]) && $directives[8]==1) ? getRobotHTML()   : ""; ?>
<?php echo (isset($settings["injRobotHTML"])) ? formatHTML($settings["injRobotHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[9]) && $directives[9]==1) ? getNoCollectHTML()   : ""; ?>
<?php echo (isset($settings["injNoCollectHTML"])) ? formatHTML($settings["injNoCollectHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML2()   : ""; ?>
<?php echo (isset($settings["injHead2HTML"])) ? formatHTML($settings["injHead2HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[2]) && $directives[2]==1) ? getTopHTML()    : ""; ?>
<?php echo (isset($settings["injTopHTML"])) ? formatHTML($settings["injTopHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["actMsgOn"])) { 
       echo formatHTML($settings["actMsg"]); 
   }
   if (isset($settings["errMsgOn"])) { 
       echo formatHTML($settings["errMsg"]); 
   }
   if (isset($settings["customMsgOn"])) { 
       echo formatHTML($settings["customMsg"]); 
   }
?>
<?php echo (isset($directives[3]) && $directives[3]==1) ? getLegalHTML()  : ""; ?>
<?php echo (isset($settings["injLegalHTML"])) ? formatHTML($settings["injLegalHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altLegalOn"])) { 
       echo formatHTML($settings["altLegalMsg"]); 
   } 
?>
<?php echo (isset($directives[4]) && $directives[4]==1) ? getEmailHTML(intval($emailmethod),$email)  : ""; ?>
<?php echo (isset($settings["injEmailHTML"])) ? formatHTML($settings["injEmailHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[5]) && $directives[5]==1) ? getStyleHTML()  : ""; ?>
<?php echo (isset($settings["injStyleHTML"])) ? formatHTML($settings["injStyleHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[6]) && $directives[6]==1) ? getVanityHTML() : ""; ?>
<?php echo (isset($settings["injVanityHTML"])) ? formatHTML($settings["injVanityHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altVanityOn"])) {
        echo formatHTML($settings["altVanityMsg"]);
    }
?>
<?php echo (isset($directives[7]) && $directives[7]==1) ? getBottomHTML() : ""; ?>
<?php echo (isset($settings["injBottomHTML"])) ? formatHTML($settings["injBottomHTMLMsg"]) : ""; ?>

